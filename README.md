# SpotiyGlobal

**Due to the regulations of the Spotify API, our application only works for pre-approved and pre-added Spotify accounts. 
As a demo, we’ve linked our [video demo](https://drive.google.com/file/d/1gDyqY2lWnqX8NVASVoCYW83ZSSNnLHJu/view).**

### Project Goals and Motivation

Music is an essential part of many people’s every day, whether they’re listening to it on their commute, during work, or for leisure. Humans are also inherently inward-looking creatures, leading to a plethora of analysis tools for our personal data. That’s why there exist so many Spotify analysis tools. People want to see what they’re listening to the most.
However, many of the tools that currently exist only look at a user’s data in isolation. By building Spotify Global, we wanted to show users how their music tastes compare with different countries around the world, as well as introduce them to songs from that country that would be the most appealing to them.

### Intended Audience and Use Cases

Our intended use case is for music listeners who have developed their own music taste but are too comfortable in what they have discovered already geographically. They want to discover new music from artists that are from countries they wouldn’t typically listen to.

### Related Materials and Inspiration

In brainstorming how we wanted to analyze a user’s Spotify data, we explored this website, which showed 13 different Spotify analysis tools. We knew that this market was definitely saturated, but wanted to see if there was anything new to make with the datasets we had found.

### Data Source
Initially, we found many Kaggle datasets containing Spotify data, whether it was the top 10 songs of any artist or a plain set of Spotify tracks and their attributes. However, the one that caught our attention was the Spotify Charts dataset which had all of the Top 200 and Viral 50 global charts since 2017. The amount of data that it contained was very useful and enabled us to come up with the idea of Spotify Global.
After a quick count, we realized that the dataset kept track of the Viral 50 songs for more countries. Additionally, the most recent data was collected in December of 2021 so we filtered the dataset to only keep the Viral 50 songs of all possible countries from that month. The songs displayed on the website from each selected country is therefore the songs from that month and for that country. 
To personalize the interaction, we integrated Spotify login using their Web API. After the user logs into our application, we utilize their credentials to retrieve their top 50 songs from the past 4 weeks from Spotify and generate a summary of their top genres, artists, and songs. We also generate a spider plot of the average audio features of their top songs (danceability, instrumentalness, popularity, valence, energy), which was also retrieved from the Spotify API. The user can then hover over different countries in the map and see the top 10 songs from that country. If they click on a particular country, they can compare their listening activity to the spider plot of the country’s viral songs. The audio features of the viral songs for each country were similarity retrieved from the Spotify, and users can also view a summary of their listening activity from the last 6 months and all time, in addition to the default last 4 weeks, thanks to the data generated by Spotify. 

### Design Process
	For our design process, we thought a lot about what we would want if we were discovering music from different countries. A particular sketch that was modified a bit was our world map discovery page. At first, we wanted to have the user select the continent they were interested in exploring first. This would then zoom into a more detailed view of the continent, allowing the user to more easily select the country in question. By hovering as well, they could see a summary of this country’s chart: the most popular artist, genre, and song. However, in testing this, we found that this design was not effective and also not as feasible as we had imagined. Continent selection proved finicky to work with and also constriction for the user in terms of zoom. Instead, we opted for the user to be able to zoom in and out, as well as drag freely around the map. In addition, the summary we had originally planned for collapsed a lot of the detail and nuance that comes from each country’s viral 50 chart. Many songs are still popular worldwide, so the same artists, genres, and songs may pop up for each one. To combat this, we decided to show more detail by disclosing the top 10 songs from the country if the user were to hover over the country path.
	Something that we had not included in our initial sketches before was the personal summary page. However, as we were working on the data, we realized that it would be useful for the user to better understand their personal listening habits before exploring other countries. Thus, we decided to begin the visualization with a page that depicts characteristics of the user’s listening habits, such as genres they frequently listen to, their current top 5 artists, and their current top 5 songs. Primed with this knowledge, the user is ready to begin exploring global data.

### Final Design
	Lots of our final design decisions came during our implementation. In the end, we had a total of 6 steps for the user to go through.
Login Page: We wanted the user to be forced to log in before they could move on to other pages that may or may not have contained their user data. We give a small tagline as well as a button that takes them to a page to enter their account credentials.
Explanation Page: Here, we provide the user with some extra information as to what they can expect from Spotify Global. We also give some context for why we decided to make Spotify Global in the first place. Finally, we include a list of resources and datasets used in order to make the application. This page also gives more instructions about how they can use the website.
User Summary Page: This page shows the user a summary of the music that they tend to listen to (to confirm that they have successfully logged in). In order to do this in the most succinct and effective way possible, we show them their top genres, artists, and songs.
World Map Page: The provided world map gives the user a chance to explore around the world and see what the top 10 songs are from each country. We used colors to signify which countries were valid to click on and which weren’t, the white being invalid, light green being valid, and dark green indicating that they were already hovering on it. Since countries can also be tough to navigate around, we gave them a zoom-in and out feature so that they can hover on the smaller countries (and a reset button).
Radar Plot Page: Now that the user has officially selected a country that they want to compare their own music to, we provide them with radar plots. There is one for them and one for the country in question, giving a basic summary as to the average danceability, energy, valence, popularity, acousticness, and instrumentalness of the music that they (or that country) listen to. In addition, since it might be hard to compare the two plots just by looking at them, we combine the two plots right below and provide a quantitative analysis. They can also choose between using summaries of their last 4 weeks, 6 months, or all-time music listening history — in case their taste has changed a lot.
Song Recommendation Page: Finally, we give the user the top 5 songs from their chosen country’s chart that best fit their music taste. This recommendation algorithm will be detailed in the next section. Here, we also allow the user to choose between using their summary of music taste in a certain time frame, similar to how we did with the radar plot page.

### Final Implementation

The Spotify login flow was integrated in Flask. When the user clicks the login button and authorizes access to our application, we use their credentials to fetch the top 50 songs from the last 4 weeks and pass it into our main HTML file. Using these songs, we fetch the audio features from the Spotify API and generate the visualizations in the following screens. 


Using the fetched song data, a list of all the genres of these top 50 songs is made and displayed to the user. Then, the top 5 artists are determined by calculating which five artists have the highest frequency in the user’s top 50 songs. The top 5 songs are the first 5 songs returned in the top 50 list since Spotify automatically ranks the results. The results can vary depending on the time filter selected since this will change the top 50 songs returned. 

This map was implemented using this geojson file and Antarctica and Greenland were removed manually. The hovering, clicking, and deselecting functions were implemented to help a user keep track of which countries they’d selected or were interested in comparing their music taste with. This dataset unfortunately didn’t have song information about all the countries so we greyed them out to indicate that. The map is also zoomable to help select smaller countries. 

Once a country hovered over, a preview of their top 10 songs is displayed to the right. However, the radar plots showing the comparison of music taste isn’t generated unless one clicks and selects a country from the map. 
We implemented three radar plots. The two on the top indicate the six features (danceability, energy, popularity, acousticness, instrumentainess, and valence) from the user’s logged in Spotify account (which they’re also allowed to change what time period of songs they select between either 4 weeks, 6 months, or all-time). The final radar plot below overlays the two up top for an easier comparison and has numerical comparisons for all the features. 
These recommendations were generated using the Sum of Squared Differences (SSD)/Least Squared Difference Method. After a user selects a country, we calculating their average danceability, energy, popularity, valence, and instrumentalness of the user and find the differences between the corresponding feature in the song. After summing up the differences, we took the songs with the smallest 5 differences and outputted the playlist above. These recommendations can change based on if the user wants their data to be based from the last 4 weeks/6 months/all-time. 
